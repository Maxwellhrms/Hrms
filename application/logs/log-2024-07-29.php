<?php defined('BASEPATH') OR exit('No direct script access allowed'); ?>

ERROR - 2024-07-29 12:14:08 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 15:02:17 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 16:28:18 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 19:16:49 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 19:17:01 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 19:17:18 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 19:17:23 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 19:17:39 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 22:08:02 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 22:21:14 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 22:28:06 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where mxemp_emp_division_code = ->userdata('user_division') and mxemp_emp_state_' at line 5 - Invalid query: select mxd_name as divisionname, mxemp_emp_gender, mxemp_emp_resignation_status, COUNT(*) AS employee_count from maxwell_employees_info 
        inner join maxwell_division_master on mxd_id = mxemp_emp_division_code
        inner join maxwell_state_master on mxst_id = mxemp_emp_state_code
        inner join maxwell_branch_master on mxb_id = mxemp_emp_branch_code
        GROUP BY mxemp_emp_gender, mxemp_emp_resignation_status,mxemp_emp_division_code order by mxemp_emp_resignation_status desc where mxemp_emp_division_code = ->userdata('user_division') and mxemp_emp_state_code = ->userdata('user_state') and mxemp_emp_branch_code in ('1')
ERROR - 2024-07-29 22:29:18 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_br' at line 5 - Invalid query: select mxd_name as divisionname, mxemp_emp_gender, mxemp_emp_resignation_status, COUNT(*) AS employee_count from maxwell_employees_info 
        inner join maxwell_division_master on mxd_id = mxemp_emp_division_code
        inner join maxwell_state_master on mxst_id = mxemp_emp_state_code
        inner join maxwell_branch_master on mxb_id = mxemp_emp_branch_code
        GROUP BY mxemp_emp_gender, mxemp_emp_resignation_status,mxemp_emp_division_code order by mxemp_emp_resignation_status desc where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_branch_code in ('1')
ERROR - 2024-07-29 22:35:23 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 22:35:43 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' mxesi_emp_types) > 0' at line 9 - Invalid query: SELECT *
FROM `maxwell_esi_master`
WHERE `mxesi_status` = 1
AND `mxesi_div_id` IS NULL
AND `mxesi_state_id` IS NULL
AND `mxesi_branch_id` IS NULL
AND `mxesi_affect_from` <= '2024-07-29'
AND `mxesi_affect_to` >= '2024-07-29'
AND FIND_IN_SET(, mxesi_emp_types) > 0
ERROR - 2024-07-29 23:09:02 --> Query error: Unknown column 'mxemp_emp_division_code' in 'having clause' - Invalid query: select mxemp_emp_fname as name, mxemp_emp_img as image, mxemp_emp_phone_no as phone, mxemp_emp_email_id as email, employee_code as employeecode,mxb_name as branchname, attendance_date, COUNT(*) AS punches_count,MIN(attendance_time) AS first_punch, MAX(attendance_time) as last_punch from employee_punches_2024 
        inner join maxwell_employees_info on employee_code = mxemp_emp_id 
        inner join maxwell_branch_master on mxb_id = mxemp_emp_branch_code
        inner join maxwell_state_master on mxst_id = mxemp_emp_state_code
        inner join maxwell_division_master on mxd_id = mxemp_emp_division_code
        where DATE(attendance_date) = '2024-07-28' GROUP BY employee_code HAVING punches_count >= 2 AND MIN(TIME(attendance_time)) >= '09:35:00' AND MAX(TIME(attendance_time)) <= '17:59:59' and mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_branch_code in ('1','3')
ERROR - 2024-07-29 23:12:15 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_br' at line 23 - Invalid query: SELECT mx_attendance_emp_code AS employeecode,mxemp_emp_fname AS name, mxb_name AS branchname, mxemp_emp_img AS image, mxemp_emp_phone_no AS phone, mxemp_emp_email_id AS email,
    SUM(CASE WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half = 'AB' THEN 1 ELSE 0 END) AS Absent,
    SUM(CASE WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half != 'AB' THEN 0.5 ELSE 0 END) AS First_Half_Absent,
    SUM(CASE WHEN mx_attendance_second_half = 'AB' AND mx_attendance_first_half != 'AB' THEN 0.5 ELSE 0 END) AS Second_Half_Absent,
    SUM(CASE WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half = 'WO' THEN 1 ELSE 0 END) AS WO,
    SUM(CASE WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half != 'WO' THEN 0.5 ELSE 0 END) AS First_Half_WO,
    SUM(CASE WHEN mx_attendance_second_half = 'WO' AND mx_attendance_first_half != 'WO' THEN 0.5 ELSE 0 END) AS Second_Half_WO,
    SUM(
        CASE 
            WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half = 'AB' THEN 1
            WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half != 'AB' THEN 0.5
            WHEN mx_attendance_second_half = 'AB' AND mx_attendance_first_half != 'AB' THEN 0.5
            WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half = 'WO' THEN 1
            WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half != 'WO' THEN 0.5
            WHEN mx_attendance_second_half = 'WO' AND mx_attendance_first_half != 'WO' THEN 0.5
            ELSE 0
        END
    ) AS total_absent_days FROM maxwell_attendance_2024_07 
    INNER JOIN maxwell_employees_info ON mxemp_emp_id = mx_attendance_emp_code 
    INNER JOIN maxwell_branch_master ON mxb_id = mxemp_emp_branch_code 
    inner join maxwell_division_master on mxd_id = mxemp_emp_division_code
    inner join maxwell_state_master on mxst_id = mxemp_emp_state_code
    WHERE mxemp_emp_resignation_status != 'R' AND mx_attendance_date BETWEEN CURDATE() - INTERVAL 7 DAY AND CURDATE() GROUP BY mx_attendance_emp_code HAVING total_absent_days >= 7 where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_branch_code in ('1','3')
ERROR - 2024-07-29 23:12:56 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_br' at line 23 - Invalid query: SELECT mx_attendance_emp_code AS employeecode,mxemp_emp_fname AS name, mxb_name AS branchname, mxemp_emp_img AS image, mxemp_emp_phone_no AS phone, mxemp_emp_email_id AS email,
    SUM(CASE WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half = 'AB' THEN 1 ELSE 0 END) AS Absent,
    SUM(CASE WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half != 'AB' THEN 0.5 ELSE 0 END) AS First_Half_Absent,
    SUM(CASE WHEN mx_attendance_second_half = 'AB' AND mx_attendance_first_half != 'AB' THEN 0.5 ELSE 0 END) AS Second_Half_Absent,
    SUM(CASE WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half = 'WO' THEN 1 ELSE 0 END) AS WO,
    SUM(CASE WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half != 'WO' THEN 0.5 ELSE 0 END) AS First_Half_WO,
    SUM(CASE WHEN mx_attendance_second_half = 'WO' AND mx_attendance_first_half != 'WO' THEN 0.5 ELSE 0 END) AS Second_Half_WO,
    SUM(
        CASE 
            WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half = 'AB' THEN 1
            WHEN mx_attendance_first_half = 'AB' AND mx_attendance_second_half != 'AB' THEN 0.5
            WHEN mx_attendance_second_half = 'AB' AND mx_attendance_first_half != 'AB' THEN 0.5
            WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half = 'WO' THEN 1
            WHEN mx_attendance_first_half = 'WO' AND mx_attendance_second_half != 'WO' THEN 0.5
            WHEN mx_attendance_second_half = 'WO' AND mx_attendance_first_half != 'WO' THEN 0.5
            ELSE 0
        END
    ) AS total_absent_days FROM maxwell_attendance_2024_07 
    INNER JOIN maxwell_employees_info ON mxemp_emp_id = mx_attendance_emp_code 
    INNER JOIN maxwell_branch_master ON mxb_id = mxemp_emp_branch_code 
    inner join maxwell_division_master on mxd_id = mxemp_emp_division_code
    inner join maxwell_state_master on mxst_id = mxemp_emp_state_code
    WHERE mxemp_emp_resignation_status != 'R' AND mx_attendance_date BETWEEN CURDATE() - INTERVAL 7 DAY AND CURDATE()  where mxemp_emp_division_code = 1 and mxemp_emp_state_code = 36 and mxemp_emp_branch_code in ('1','3') GROUP BY mx_attendance_emp_code HAVING total_absent_days >= 7
